ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(x=musicality_mean, xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5)
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(x=musicality_mean, xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbarh(data=SE_musicality, aes(x=musicality_mean, xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(x=musicality_mean), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(x=musicality_mean, xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
merge(SE_musicality, master_long, by=c("pre_post", "liking")
merge(SE_musicality, master_long, by=c("pre_post", "liking"))
master_long <- merge(SE_musicality, master_long, by=c("pre_post", "liking"))
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(aes(x=musicality_mean, xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarv(aes(x=musicality_mean, xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(aes(xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(aes(xmin = musicality_mean-SE_musicality, xmax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(aes(ymin = musicality_mean-SE_musicality, ymax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(data=SE_musicality, aes(ymin = musicality_mean-SE_musicality, ymax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
musicality_means_pre <-
master_long %>%
subset(pre_post=="pre") %>%
group_by(liking, pre_post) %>%
dplyr::summarize(musicality = mean(musicality, na.rm=TRUE)) %>%
drop_na()
SE_musicality_pre <-
master_long %>%
subset(pre_post=="pre") %>%
group_by(liking, pre_post) %>%
dplyr::summarize(musicality_sd = sd(musicality, na.rm=TRUE)) %>%
drop_na()
master_long_pre <- master_long %>%
subset(pre_post=="pre")
SE_musicality_pre$freq <-table(master_long_pre$liking)
SE_musicality_pre$SE_musicality <- (SE_musicality_pre$musicality_sd)/(sqrt(SE_musicality_pre$freq))
musicality_means_post <-
master_long %>%
subset(pre_post=="post") %>%
group_by(liking, pre_post) %>%
dplyr::summarize(musicality = mean(musicality, na.rm=TRUE)) %>%
drop_na()
SE_musicality_post <-
master_long %>%
subset(pre_post=="post") %>%
group_by(liking, pre_post) %>%
dplyr::summarize(musicality_sd = sd(musicality, na.rm=TRUE)) %>%
drop_na()
master_long_post <- master_long %>%
subset(pre_post=="post")
SE_musicality_post$freq <-table(master_long_post$liking)
SE_musicality_post$SE_musicality <- (SE_musicality_post$musicality_sd)/(sqrt(SE_musicality_post$freq))
SE_musicality_post <- merge(SE_musicality_post, musicality_means_post, by=c("liking", "pre_post"))
SE_musicality_pre <- merge(SE_musicality_pre, musicality_means_pre, by=c("liking", "pre_post"))
SE_musicality <- rbind(SE_musicality_pre, SE_musicality_post)
master_long <- merge(SE_musicality, master_long, by=c("pre_post", "liking"))
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(data=SE_musicality, aes(ymin = musicality_mean-SE_musicality, ymax = musicality_mean-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(data=SE_musicality, aes(ymin = musicality-SE_musicality, ymax = musicality-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
View(SE_musicality)
master_long <- speech_master %>%
select("ResponseId", "stim", "musicality") %>%
merge(liking_master, by=c("ResponseId", "stim"))
master_long$stim <- as.factor(master_long$stim)
master_long$pre_post <- as.factor(master_long$pre_post)
master_long$pre_post <- factor(master_long$pre_post, levels = c("pre", "post"))
contrasts(master_long$pre_post) <- c(-0.5,0.5)
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(data=SE_musicality, aes(ymin = musicality-SE_musicality, ymax = musicality-SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
SE_musicality$upper <-
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(data=SE_musicality, aes(ymin = musicality-SE_musicality, ymax = musicality+SE_musicality), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
SE_musicality$upper <- musicality-SE_musicality
SE_musicality$upper <- SE_musicality$musicality-SE_musicality$SE_musicality
SE_musicality$lower <- SE_musicality$musicality-SE_musicality$SE_musicality
SE_musicality$upper <- SE_musicality$musicality+SE_musicality$SE_musicality
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(data=SE_musicality, aes(ymin = lower, ymax = upper), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(ymin = lower, ymax = upper), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(xmin = lower, xmax = upper), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(xmin = lower, xmax = upper), alpha=0.5, width=0) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(xmin = lower, xmax = upper,  width=0), alpha=0.5) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(xmin = lower, xmax = upper), alpha=0.5,  width=0) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbarh(data=SE_musicality, aes(xmin = lower, xmax = upper), alpha=0.5,  width=0) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
master <- read.csv(file='../data/master.csv')
matched <- read.csv(file='../data/anhedonics_matchedcontrols.csv')
liking_master <- master %>%
subset(rating=="liking")
liking_master_pre <- master %>%
subset(rating=="liking") %>%
subset(pre_post=="pre")
liking_master_pre$pre <- liking_master_pre$value
liking_master_post <- master
liking_master_post$post <- liking_master_post$value
liking_master_post <-
liking_master_post %>%
subset(rating=="liking") %>%
subset(pre_post=="post") %>%
select(ResponseId, stim, post)
liking_masterprepost <- merge(liking_master_pre, liking_master_post, by=c("ResponseId", "stim"))
liking_masterprepost$change <- liking_masterprepost$post - liking_masterprepost$pre
liking_matched_pre <- matched %>%
subset(rating=="liking") %>%
subset(pre_post=="pre")
liking_matched_pre$pre <- liking_matched_pre$value
liking_matched_post <- matched
liking_matched_post$post <- liking_matched_post$value
liking_matched_post <-
liking_matched_post %>%
subset(rating=="liking") %>%
subset(pre_post=="post") %>%
select(ResponseId, stim, post)
liking_matchedprepost <- merge(liking_matched_pre, liking_matched_post, by=c("ResponseId", "stim"))
liking_matchedprepost$change <- liking_matchedprepost$post - liking_matchedprepost$pre
speech_master <- master %>%
subset(rating=="speech")
speech_master_pre <- master %>%
subset(rating=="speech") %>%
subset(pre_post=="pre")
speech_master_pre$pre <- speech_master_pre$value
speech_master_post <- master
speech_master_post$post <- speech_master_post$value
speech_master_post <-
speech_master_post %>%
subset(rating=="speech") %>%
subset(pre_post=="post") %>%
select(ResponseId, stim, post)
speech_masterprepost <- merge(speech_master_pre, speech_master_post, by=c("ResponseId", "stim"))
speech_masterprepost$change <- speech_masterprepost$post - speech_masterprepost$pre
speech_matched <- matched %>%
subset(rating=="speech")
speech_matched_pre <- matched %>%
subset(rating=="speech") %>%
subset(pre_post=="pre")
speech_matched_pre$pre <- speech_matched_pre$value
speech_matched_post <- matched
speech_matched_post$post <- speech_matched_post$value
speech_matched_post <-
speech_matched_post %>%
subset(rating=="speech") %>%
subset(pre_post=="post") %>%
select(ResponseId, stim, post)
speech_matchedprepost <- merge(speech_matched_pre, speech_matched_post, by=c("ResponseId", "stim"))
speech_matchedprepost$change <- speech_matchedprepost$post - speech_matchedprepost$pre
speech_masterprepost$musicality_pre <- speech_masterprepost$pre
speech_masterprepost$musicality_post <- speech_masterprepost$post
speech_masterprepost$musicality_change <- speech_masterprepost$change
liking_masterprepost$liking_pre <- liking_masterprepost$pre
liking_masterprepost$liking_post <- liking_masterprepost$post
liking_masterprepost$liking_change <- liking_masterprepost$change
master_prepost <- speech_masterprepost %>%
select("ResponseId", "stim", "musicality_pre", "musicality_post", "musicality_change") %>%
merge(liking_masterprepost, by=c("ResponseId", "stim"))
speech_master$musicality <- speech_master$value
liking_master$liking <- liking_master$value
master_long <- speech_master %>%
select("ResponseId", "stim", "musicality") %>%
merge(liking_master, by=c("ResponseId", "stim"))
master_long$stim <- as.factor(master_long$stim)
master_long$pre_post <- as.factor(master_long$pre_post)
master_long$pre_post <- factor(master_long$pre_post, levels = c("pre", "post"))
contrasts(master_long$pre_post) <- c(-0.5,0.5)
m9 <- lmer(data=master_long, scale(liking) ~ scale(musicality)*pre_post + (scale(musicality)*pre_post|ResponseId) + (1|stim),control=lmerControl(optimizer="bobyqa"))
summary(m9)
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
# geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
#geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
View(master_long)
ggplot(data=master_long, aes(x=musicality, y=liking))+
geom_jitter(width=0.2, alpha=0.3)+
#stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
#stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
#geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
#geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
#geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
#geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Ratings") +
ylab("Liking Ratings")
ggplot(data=master_long, aes(x=musicality, y=liking))+
#geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
#geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Rating") +
ylab("Liking Rating")
View(master_long)
m9 <- lmer(data=master_long, scale(liking) ~ scale(musicality)*pre_post*stim_type + (scale(musicality)*pre_post|ResponseId) + (1|stim),control=lmerControl(optimizer="bobyqa"))
summary(m9)
summary(m9)
m7 <- lmer(data=master_prepost, scale(liking_pre) ~ scale(musicality_pre)*stim_type + (scale(musicality_pre)*stim_type|ResponseId) + (1|stim),control=lmerControl(optimizer="bobyqa"))
summary(m7)
#post
m8 <- lmer(data=master_prepost, scale(liking_post) ~ scale(musicality_post)*stim_type + (scale(musicality_post)*stim_type|ResponseId) + (1|stim),control=lmerControl(optimizer="bobyqa"))
summary(m8)
ggplot(data=master_long, aes(x=musicality, y=liking))+
#geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
#geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Rating") +
ylab("Liking Rating")
ggplot(data=master_long, aes(x=musicality, y=liking, color=stim_type))+
#geom_jitter(width=0.2, alpha=0.3)+
stat_summary(fun.data  = 'mean_se', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', alpha=0.5)+
theme_classic()+
# geom_errorbar(data=SE, aes(ymin = lower_liking, ymax = upper_liking), alpha=0.5,  height=0.2)+
#geom_errorbarh(data=SE, aes(xmin = lower, xmax = upper), alpha=0.5,  height=0.2) +
geom_smooth(method="lm") +
facet_grid(~pre_post) +
xlab("Musicality Rating") +
ylab("Liking Rating")
liking_master$stim_type <- as.factor(liking_master$stim_type)
liking_master$stim <- as.factor(liking_master$stim)
liking_master$pre_post <- as.factor(liking_master$pre_post)
liking_master$pre_post <- factor(liking_master$pre_post, levels = c("pre", "post"))
contrasts(liking_master$stim_type) <- c(-0.5,0.5)
contrasts(liking_master$pre_post) <- c(-0.5,0.5)
m2 <- lmer(data=liking_master, scale(value) ~ stim_type*pre_post + (stim_type*pre_post|ResponseId) + (1|stim),control=lmerControl(optimizer="bobyqa"))
summary(m2)
ggplot(data=liking_master, aes(x=pre_post, y=value, color=stim_type)) +
# ggdist::geom_dotsinterval() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
theme_classic()+
theme(legend.position = "none")+
ylab("Liking Rating") +
xlab("Pre vs. Post Repetition")
#change
m10 <- lmer(data=master_prepost, scale(liking_change) ~ scale(musicality_change)*stim_type + (scale(musicality_change)*stim_type|ResponseId) + (1|stim),control=lmerControl(optimizer="bobyqa"))
summary(m10)
liking_masterprepost$stim_type <- as.factor(liking_masterprepost$stim_type)
contrasts(liking_masterprepost$stim_type) <- c(-0.5,0.5)
m4 <- lmer(data=liking_masterprepost, scale(change) ~ stim_type*scale(eBMRQ_total) + (stim_type:scale(eBMRQ_total)|ResponseId) + (1|stim),control=lmerControl(optimizer="bobyqa"))
summary(m4)
test(emmeans::emtrends(m9, pairwise ~ stim_type, var = "scale(change)", lmer.df = "satterthwaite",lmerTest.limit = 65492))
test(emmeans::emtrends(m4, pairwise ~ stim_type, var = "scale(change)", lmer.df = "satterthwaite",lmerTest.limit = 65492))
test(emmeans::emtrends(m4, pairwise ~ stim_type, var = "change", lmer.df = "satterthwaite",lmerTest.limit = 65492))
test(emmeans::emtrends(m4, pairwise ~ stim_type, var = "scale(eBMRQ_total)", lmer.df = "satterthwaite",lmerTest.limit = 65492))
test(emmeans::emtrends(m4, pairwise ~ stim_type, var = "eBMRQ_total", lmer.df = "satterthwaite",lmerTest.limit = 65492))
library(MatchIt)
library(tidyverse)
master <- read.csv(file="../data/master.csv")
mean(ratings$PASS_noaud) + sd(ratings$PASS_noaud)
mean(master$PASS_noaud) + sd(master$PASS_noaud)
View(master)
master <- read.csv(file="../data/master.csv") %>%
pivot_wider(id_cols=ResponseID)
master <- read.csv(file="../data/master.csv") %>%
pivot_wider(id_cols=ResponseId)
View(master)
master <- read.csv(file="../data/master.csv")
View(master)
master <- read.csv(file="../data/master.csv") %>%
distinct(ResponseId)
master <- read.csv(file="../data/master.csv") %>%
distinct(ResponseId, .keep_all = TRUE)
View(master)
mean(master$PASS_noaud) + sd(master$PASS_noaud)
quantile(master$eBMRQ_total, probs = c(.1), na.rm=TRUE)
master %>% distinct(ResponseId, .keep_all = TRUE) %>%
ggplot(aes(x=PASS_noaud, y=eBMRQ_total))+
geom_point(alpha=0.65) +
geom_hline(yintercept = 67, linetype="dotted", color="blue") +
geom_vline(xintercept = 16.84785, linetype="dotted", color="red") +
theme_classic() +
xlab("PAS Scores (Sound Items Removed)") +
ylab("Total eBMRQ Scores")
general_hedonics <-
master %>%
subset(PASS_noaud<16.84785)
musical_anhedonics <- subset(general_hedonics, eBMRQ_total< 67)
musical_anhedonics$group = "Anhedonic"
hedonics <- subset(general_hedonics, eBMRQ_total > 67)
