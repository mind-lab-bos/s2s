---
title: "1_cleaningscoring"
output: html_document
date: "2024-04-19"
---

```{r}
library(tidyverse)
source("reverseCode.R")
```

```{r}
data <- read.csv(file='../data/s2s_April 18, 2024_08.54.csv')
```

```{r}
ratings <- data %>%
  select("ResponseId", "X1_Q397":"X48_Q454")
```

```{r}
bmrq <- data %>%
  dplyr::select("X1..When.I.share.music.with.someone.I.feel.a.special.connection.with.that.person....Completely.Disagree.Completely.Agree":"X20..When.I.hear.a.tune.I.like.a.lot.I.can.t.help.tapping.or.moving.to.its.beat....Completely.Disagree.Completely.Agree")

# BMRQ columns to reverse code and sub-score
cols_reverse <- c("X2..In.my.free.time.I.hardly.listen.to.music....Completely.Disagree.Completely.Agree",
                  "X5..I.don.t.like.to.dance..not.even.with.music.I.like....Completely.Disagree.Completely.Agree")

cols_emotion <- c("X3..I.like.listen.to.music.that.contains.emotion....Completely.Disagree.Completely.Agree",
  "X8..I.get.emotional.listening.to.certain.pieces.of.music....Completely.Disagree.Completely.Agree",
  "X12..I.can.become.tearful.or.cry.when.I.listen.to.a.melody.that.I.like.very.much....Completely.Disagree.Completely.Agree",
  "X18..I.sometimes.feel.chills.when.I.hear.a.melody.that.I.like....Completely.Disagree.Completely.Agree")

cols_sensorimotor <-c("X5..I.don.t.like.to.dance..not.even.with.music.I.like....Completely.Disagree.Completely.Agree",
  "X10..Music.often.makes.me.dance....Completely.Disagree.Completely.Agree",
  "X15..I.can.t.help.humming.or.singing.along.to.music.that.I.like....Completely.Disagree.Completely.Agree",
  "X20..When.I.hear.a.tune.I.like.a.lot.I.can.t.help.tapping.or.moving.to.its.beat....Completely.Disagree.Completely.Agree")
                      
cols_moodreg <- c("X4..Music.keeps.me.company.when.I.m.alone....Completely.Disagree.Completely.Agree",
  "X9..Music.calms.and.relaxes.me....Completely.Disagree.Completely.Agree",
  "X14..Music.helps.me.chill.out....Completely.Disagree.Completely.Agree",
  "X19..Music.comforts.me....Completely.Disagree.Completely.Agree")

cols_musicseek <- c("X2..In.my.free.time.I.hardly.listen.to.music....Completely.Disagree.Completely.Agree",
  "X7..I.inform.myself.about.music.I.like....Completely.Disagree.Completely.Agree",
  "X11..I.m.always.looking.for.new.music....Completely.Disagree.Completely.Agree",
  "X17..I.spend.quite.a.bit.of.money.on.music.and.related.items....Completely.Disagree.Completely.Agree")

cols_socialreward <-c("X1..When.I.share.music.with.someone.I.feel.a.special.connection.with.that.person....Completely.Disagree.Completely.Agree",
  "X6..Music.makes.me.bond.with.other.people....Completely.Disagree.Completely.Agree",
  "X13..I.like.to.sing.or.play.an.instrument.with.other.people....Completely.Disagree.Completely.Agree",
                     "X16..At.a.concert.I.feel.connected.to.the.performers.and.the.audience....Completely.Disagree.Completely.Agree")


# Reverse code
bmrq[cols_reverse] <- lapply(bmrq[cols_reverse], reverseCode)


# Add sub-scores and total to main df
ratings$BMRQ_total <- apply(bmrq,1, sum) # total BMRQ scores --> Need to add absorption scores
ratings$BMRQ_emotion <- apply(bmrq[cols_emotion], 1,sum)
ratings$BMRQ_sensorimotor <- apply(bmrq[cols_sensorimotor],1, sum)
ratings$BMRQ_moodreg <-apply(bmrq[cols_moodreg],1, sum)
ratings$BMRQ_musicseek <- apply(bmrq[cols_musicseek],1, sum)
ratings$BMRQ_socialreward <- apply(bmrq[cols_socialreward],1, sum)

quantile(ratings$BMRQ_total, probs = c(.1), na.rm=TRUE)
```

```{r}
cols_absorption <- c("X22..I.sometimes.feel.like.I.am..one..with.the.music....Completely.Disagree.Completely.Agree", "X23..While.listening.to.music..I.may.become.so.involved.that.I.may.forget.about.myself.and.my.surroundings....Completely.Disagree.Completely.Agree", "X24..It.is.sometimes.possible.for.me.to.be.completely.immersed.in.music.and.to.feel.as.if.my.whole.state.of.consciousness.has.been.temporarily.altered....Completely.Disagree.Completely.Agree", "X25..When.listening.to.great.music.I.sometimes.feel.as.if.I.am.being.lifted.into.the.air....Completely.Disagree.Completely.Agree")

df$BMRQ_absorption <- apply(bmrq[cols_absorption],1, sum)

```